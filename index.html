<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wplace像素字转换器</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" type="image/x-icon" href="./favicon.ico">
  <style>
  /* 字体定义保持不变 */
  @font-face { font-family: 'Dingmao Pixel'; src: url('./fonts/dingmaodianzhen.ttf') format('truetype'); font-display: swap; }
  @font-face { font-family: 'ZhiXie Ti'; src: url('https://cdn.jsdelivr.net/gh/max32002/zhixie@latest/ZhiXieTi.ttf') format('truetype'); font-display: swap; }
  @font-face { font-family: 'ZhanKu KuaiLe Ti'; src: url('./fonts/ZhanKuKuaiLeTi2016XiuDingBan-1.ttf') format('truetype'); font-display: swap; }
  @font-face { font-family: 'FangZheng ShuTi'; src: url('https://cdn.jsdelivr.net/gh/max32002/fangzhengshuti@latest/FangZhengShuTi.ttf') format('truetype'); font-display: swap; }
  @font-face { font-family: 'HengShui Ti'; src: url('./fonts/hengshuiti.ttf') format('truetype'); font-display: swap; }
  @font-face { font-family: 'XingKai'; src: url('./fonts/华文行楷.ttf') format('truetype'); font-display: swap; }
  @font-face { font-family: 'MaoTi'; src: url('./fonts/maozedong-1.ttf') format('truetype'); font-display: swap; } 
  @font-face { font-family: 'SourceHanSansK-ExtraLight'; src: url('./fonts/思源黑体SourceHanSansK-ExtraLight.ttf') format('truetype'); font-display: swap; } 
  @font-face { font-family: 'Dingmao Pixel_9px'; src: url('./fonts/dingmao_9px.ttf') format('truetype'); font-display: swap; } 
  @font-face { font-family: 'FangZheng ShuTi'; src: url('./fonts/方正舒体.TTF') format('truetype'); font-display: swap; } 
  @font-face { font-family: 'FangZheng XiaoBiaoSong'; src: url('./fonts/方正小标宋.TTF') format('truetype'); font-display: swap; } 
  @font-face { font-family: 'Huiwenmingchao'; src: url('./fonts/Huiwenminchao.ttf') format('truetype'); font-display: swap; } 
  @font-face { font-family: 'HanYiChangMeiHeiJian'; src: url('./fonts/HanYiChangMeiHeiJian.ttf') format('truetype'); font-display: swap; } 
  @font-face { font-family: 'Fangsong_GB2312'; src: url('./fonts/仿宋_GB2312.TTF') format('truetype'); font-display: swap; } 
  </style>
</head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-G048820J9K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-G048820J9K');
</script>
<body>
  <main class="app">
    <aside class="sidebar" aria-label="侧栏">
      <header class="brand">
        <h1 class="title">像素字转换器</h1>
        <p class="subtitle">使用 64 色画板，把任意 Unicode 文本转换为像素化艺术字并导出图片</p>
      </header>

      <section class="sidebarInfo">
        <p class="sidebarFoot">点击任一色块打开画板；画板分「非付费色」与「付费色」。鼠标悬停显示颜色名称。</p>
      </section>
      <section class="sidebarInfo">
        <p class="sidebarFoot">丁卯点阵体的字体大小应设置为宽度加一的整倍数。比如丁卯点阵体（9px）的字体大小就要设置成10px的整倍数</p>
      </section>
      <section class="sidebarInfo">
        <p class="sidebarFoot">若字体样式不满足预期，请点击“渲染预览”按钮重新渲染。若有按钮被遮住，请用Ctrl+滚轮调整页面比例</p>
      </section>
    </aside>

    <section class="main">
      <div class="previewTop">
        <div class="previewHeader">
          <h3>预览</h3>
          <div class="meta">使用画板 64 色映射输出像素艺术字</div>
        </div>

        <div class="controlsInline">
          <label>背景</label>
          <select id="bgMode"><option value="transparent">透明</option><option value="solid" selected>纯色</option><option value="checker">棋盘</option></select>
        </div>
      </div>

      <div class="canvasAndControls">
        <div id="canvasWrap" class="canvasWrap">
          <canvas id="previewCanvas"></canvas>
        </div>

        <section class="controls" aria-label="Controls Panel">
          <label class="fieldLabel">输入文字</label>
          <textarea id="textInput">你好 Hello</textarea>

          <div class="formRow">
            <div class="field">
              <label class="fieldLabel">字体</label>
              <select id="fontFamily">
                <option value="Arial">Arial（默认清晰）</option>
                <option value="Helvetica">Helvetica</option>
                <option value="Microsoft YaHei">微软雅黑（Win 默认）</option>
                <option value="PingFang SC">苹方 PingFang SC（macOS/iOS）</option>
                <option value="SourceHanSansK-ExtraLight">思源黑体</option>
                <option value="Dingmao Pixel" selected>丁卯点阵体（7px）</option>
                <option value="Dingmao Pixel_9px">丁卯点阵体（9px）</option>
                <option value="FangZheng ShuTi">方正舒体</option>
                <option value="ZhanKu KuaiLe Ti">站酷快乐体</option>
                <option value="XingKai">华文行楷</option>
                <option value="KaiTi">楷体</option>
                <option value="Huiwenmingchao">汇文明朝体（仿铅字印刷）</option>
                <option value="HanYiChangMeiHeiJian">汉仪长美黑（上世纪字体）</option>
                <option value="FangZheng XiaoBiaoSong">方正小标宋</option>
                <option value="Fangsong_GB2312">仿宋_GB2312</option>
                <option value="MaoTi">毛体</option>
                <option value="HengShui Ti">衡水体</option>
                <option value="Consolas">Consolas</option>
                <option value="Courier New">Courier New</option>
                <option value="Georgia">Georgia</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="SimSun">中易宋体</option>
                <option value="Serif">Serif（衬线）</option>
                <option value="Sans-Serif">Sans-Serif（无衬线）</option>
              </select>
            </div>

            <div class="field">
              <label class="fieldLabel">字号（px）</label>
              <input id="fontSize" type="number" min="8" max="400" value="8" />
            </div>
          </div>

          <div class="formRow">
            <div class="field">
              <label class="fieldLabel">粗细</label>
              <select id="fontWeight"><option value="300" selected>细</option><option value="400">中</option><option value="600">粗</option><option value="700">厚重</option></select>
            </div>

            <div class="field">
              <label class="fieldLabel">斜体</label>
              <select id="fontStyle"><option value="normal" selected>否</option><option value="italic">是</option></select>
            </div>
          </div>

          <div class="formRow">
            <div class="field">
              <label class="fieldLabel">颗粒度（一个像素的大小）</label>
              <input id="pixelSize" type="number" min="1" max="40" value="1" />
            </div>

            <div class="field">
              <label class="fieldLabel">二值化阈值（控制字体精细度）</label>
              <input id="threshold" type="number" min="0.01" max="1.00" step="0.01" value="0.5" title="数值越小笔画越粗，数值越大笔画越细" />
            </div>
          </div>
          
          <div class="formRow">
            <div class="field">
              <label class="fieldLabel">画布宽（px）</label>
              <input id="canvasW" type="number" min="64" max="5000" value="35" />
            </div>

            <div class="field">
              <label class="fieldLabel">画布高（px）</label>
              <input id="canvasH" type="number" min="64" max="5000" value="8" />
            </div>
          </div>

          <div class="formRow">
            <div class="field">
              <label class="fieldLabel">艺术字效果</label>
              <select id="artEffect">
                <option value="none" selected>无</option>
                <option value="outline">轮廓（描边）</option>
                <option value="shadow">投影</option>
                <option value="gradient">渐变（两色）</option>
              </select>
            </div>
          </div>

          <div class="colorPreviewRow" id="previewRow">
            <div class="colorPreview">
              <div class="label" id="labelFont">字体色</div>
              <button id="previewFont" class="swPreview pickerBtn" data-target="font" title="点击选择颜色"></button>
            </div>

            <div class="colorPreview" id="effectPreviewAWrap">
              <div class="label" id="labelEffectA">效果色 A</div>
              <button id="previewEffectA" class="swPreview pickerBtn" data-target="effectA" title="点击选择颜色"></button>
            </div>

            <div class="colorPreview" id="effectPreviewBWrap">
              <div class="label" id="labelEffectB">效果色 B</div>
              <button id="previewEffectB" class="swPreview pickerBtn" data-target="effectB" title="点击选择颜色"></button>
            </div>

            <div class="colorPreview">
              <div class="label" id="labelBg">背景</div>
              <button id="previewBg" class="swPreview pickerBtn" data-target="bg" title="点击选择颜色"></button>
            </div>
          </div>

          <div class="actions">
            <button id="renderBtn" class="btn primary">渲染预览</button>
            <button id="downloadBtn" class="btn">导出 PNG</button>
            <button id="resetBtn" class="btn ghost">重置</button>
          </div>
        </section>
      </div>
    </section>
  </main>

  <div id="paletteModal" class="modal hidden" aria-hidden="true">
    <div class="modalBackdrop"></div>
    <div class="modalCard" role="dialog" aria-modal="true" aria-label="色板选择">
      <div class="modalHeader">
        <div class="mhTitle">选择颜色</div>
        <button id="closeModal" class="closeBtn" aria-label="关闭">&times;</button>
      </div>

      <div class="tabs">
        <button class="tabBtn active" data-tab="free">非付费色</button>
        <button class="tabBtn" data-tab="paid">付费色</button>
      </div>

      <div class="paletteGrid" id="modalPalette"></div>
      <div class="modalFoot"><small>悬停查看颜色名称；点击选择并赋值到当前目标。</small></div>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>